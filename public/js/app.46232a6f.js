"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var app=angular.module("sortlist-challenge",["templates-all","ui.router","ngDialog","toastr","permission","permission.ui","validation.match","pascalprecht.translate","ngMessages","ui.bootstrap"]);app.config(["$httpProvider","$translateProvider",function(a,b){a.interceptors.push(["$templateCache","toastr","$q",function(a,b,c){return{request:function(b){return"GET"===b.method&&b.url.indexOf(".html")>0&&!a.get(b.url)&&(b.url=b.url.split(".").join(".en.")),b},responseError:function(a){var d=a.data&&a.data.message||a.statusText||a.data||a.message;return b.error(d),c.reject(a)}}}]),b.useUrlLoader("/api/i18n"),b.preferredLanguage("en"),b.useSanitizeValueStrategy(null)}]),app.factory("$exceptionHandler",["$injector",function(a){return function(b){a.get("toastr").error(b.message)}}]),angular.module("sortlist-challenge").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("main",{url:"/",templateUrl:"/pages/main.html",resolve:{agencies:["$http",function(a){return a.get("/api/agencies")}]},controller:"MainConrtoller"})}]),angular.module("sortlist-challenge").controller("MainConrtoller",["$scope","$window","agencies",function(a,b,c){a.agencies=c.data,a.sayHello=function(){b.alert("Hello World!")}}]),angular.module("sortlist-challenge").directive("agenciesList",function(){return{restrict:"EA",templateUrl:"/partials/agencies-list/agencies-list.html",scope:{agencies:"="},link:function(){}}}),angular.module("sortlist-challenge").directive("agencyCard",["GradeService",function(a){return{restrict:"EA",templateUrl:"/partials/agencies-list/agency-card.html",scope:{agency:"="},link:function(b){b.grade=a.getGradeByValue(b.agency.grade),b.gradeClass=b.grade?b.grade.labelClass:"",b.tags=b.agency.tags.join(", ")}}}]),angular.module("sortlist-challenge").service("GradeService",["$filter",function(a){var b=[{name:"Master",value:1,labelClass:"label-success"},{name:"Padawan",value:3,labelClass:"label-danger"},{name:"Jedi",value:2,labelClass:"label-warning"}];return{getAllGrades:function(){return angular.copy(b)},getGradeByValue:function(c){var d=a("filter")(b,{value:c});return d.pop()}}}]),angular.module("sortlist-challenge").directive("createAgencyForm",["GradeService","$http","toastr","$translate",function(a,b,c,d){return{restrict:"EA",templateUrl:"/partials/agencies-list/create-form.html",scope:{agencies:"="},link:function(e){e.nameRegex=/^[a-zA-Z0-9_ ]*$/,e.tagsRegex=/^[a-zA-Z0-9, ]*$/,e.nameMaxLength=255,e.grades=a.getAllGrades(),e.agency={},e.create=function(){var a=this;e.triedToSubmit=!0,this.createForm.$valid&&b.post("/api/agencies",e.agency).success(function(b){d("i18n.agencies.create-form.success").then(function(a){c.success(a)}),e.agencies.push(b),e.triedToSubmit=!1,e.agency={},a.createForm.$setPristine()})}}}}]),angular.module("sortlist-challenge").directive("filterAgencyForm",["$http",function(a){return{restrict:"EA",templateUrl:"/partials/agencies-list/filter-form.html",scope:{agencies:"="},link:function(b){b.filter={agencyName:"",selectedTag:""},b.selectTag=function(a){return arguments.length?void(b.filter.selectedTag=a):b.filter.selectedTag};var c=function(c,d){c!==d&&a.get("/api/agencies",{params:{tag:b.filter.selectedTag,name:b.filter.agencyName}}).success(function(a){var c;b.agencies.length=0,(c=b.agencies).push.apply(c,_toConsumableArray(a))})};b.$watch("filter.selectedTag",c),b.$watch("filter.agencyName",c),b.fetchTags=function(c){return a.get("/api/tags",{params:{name:c}}).then(function(a){var d=a.data;return 0===d.length||0===d.indexOf(c)?(b.filter.selectedTag=c,[]):a.data})}}}}]),angular.module("sortlist-challenge").run(function(){});